----------------------------------------------------------------------------------------------------------------------
      name:  master_thesis
       log:  H:/master_thesis/stata/log/master_thesis_running.log
  log type:  text
 opened on:   1 Jul 2024, 19:42:26

. 
. 
. 
. *** preamble
. {
. 
. /*--------------------------------------------------------
> MASTER THESIS
> -------------
> 
> PUTTING THE GDR'S LEGACY EFFECT UNDER THE MICROSCOPE:
> EASTERN FEMALE STEM PROFESSIONALS IN REUNIFIED GERMANY.
> 
> JOHANNES SCHÃœTT, 5574549
> FREE UNIVERSITY OF BERLIN
> 
> M.SC. PUBLIC ECONOMICS
> 
> SUPERVISOR: PROF. NATALIA DANZER, PH.D.
> 
> SUMMER TERM 2024
> 
> --------------------------------------------------------*/
. 
. version 17
. clear all
. set more off, permanently
(set more preference recorded)
. set maxvar 7000

. 
. *** preamble END
. }

. 
. 
. 
. * prepare data
. do ${do}prepare_data.do

. ** DO NOT EXECUTE THIS DO-FILE ON ITS OWN, DO MAIN.DO !! **
. 
. use ${v38}ppathl, clear
(SOEP-Core, v38.1 (EU Edition), doi:10.5684/soep.core.v38.1eu)

. keep if inrange(netto, 10, 19)
(514,453 observations deleted)

. 
. 
. * generate female dummy
. recode sex (2 = 1) (1 = 0) (nonmissing = .), gen(female)
(770609 differences between sex and female)

. 
. label variable female "Female"

. 
. label define female 0 "[0] Male", modify

. label define female 1 "[1] Female", modify

. 
. label values female female

. 
. drop if mi(female)
(23 observations deleted)

. 
. 
. * regressors of interest: year dummies and interactions with female
. forvalues year = 1991(1)1999 {
  2.         gen d`year' = 0
  3.         replace d`year' = 1 if syear == `year'
  4.         
.         gen female_d`year' = d`year' * female
  5.         
.         label variable d`year' "`year'"
  6.         label variable female_d`year' "`year' $\times$ Female"
  7. }
(13,669 real changes made)
(13,397 real changes made)
(13,179 real changes made)
(13,417 real changes made)
(13,768 real changes made)
(13,511 real changes made)
(13,283 real changes made)
(14,670 real changes made)
(14,085 real changes made)

. 
. 
. * residence west germany
. merge m:1 hid syear using ${v38}regionl, keep(3) keepusing(bula) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                           770,586  
    -----------------------------------------

. 
. recode bula (1/10 = 1) (11/16 = 0) (nonmissing = .), gen(west)
(746261 differences between bula and west)

. 
. label variable west "Residence in West Germany"

. 
. label define west 0 "[0] Does not reside in West Germany", modify

. label define west 1 "[1] Resides in West Germany", modify

. 
. label values west west

. 
. drop if mi(west)
(4 observations deleted)

. 
. * interaction term
. gen west_female = west * female

. label variable west_female "Residence in West Germany $\times$ Female"

. 
. 
. * eastern origin
. recode loc1989 (1 = 1) (2 = 0) (nonmissing = .), gen(east_origin)
(600487 differences between loc1989 and east_origin)

. 
. label variable east_origin "East German Origin"

. 
. label define east_origin 0 "[0] Does not have an East German Origin", modify

. label define east_origin 1 "[1] Has an East German Origin", modify

. 
. label values east_origin east_origin

. 
. drop if mi(east_origin)
(129,614 observations deleted)

. 
. 
. * stem profession
. merge 1:1 pid syear using ${v38}pl, keep(1 3) keepusing(p_isco88) nogen

    Result                      Number of obs
    -----------------------------------------
    Not matched                           289
        from master                       289  
        from using                          0  

    Matched                           640,679  
    -----------------------------------------

. 
. recode p_isco88 (1236 2111/2213 3111/3212 = 1) (min/0 = .) (nonmissing = 0), gen(stem)
(640679 differences between p_isco88 and stem)

. 
. label variable stem "STEM Profession"

. 
. label define stem 0 "[0] Does not have a STEM Profession", modify

. label define stem 1 "[1] Has a STEM Profession", modify

. 
. label values stem stem

. 
. drop if mi(stem)
(438,990 observations deleted)

. 
. 
. * info about employment status
. merge 1:1 pid syear using ${v38}pgen, keep(1 3) keepusing(pgemplst) nogen
(variable syear was long, now double to accommodate using data's values)

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                           201,978  
    -----------------------------------------

. 
. 
. * only individuals who are either full- or part-time employed should be marked
. * as success in stem variable
. replace stem = 0 if !inrange(pgemplst, 1, 2)
(907 real changes made)

. 
. 
. * age
. gen age = syear - gebjahr

. gen age_2 = age^2

. 
. label variable age "Age"

. label variable age_2 "Age (squared)"

. 
. 
. * keep working age population only
. keep if inrange(age, 17, 65)
(2,396 observations deleted)

. 
. 
. * partner
. recode partner (1/4 = 1) (0 5 = 0), gen(partner_bin)
(23748 differences between partner and partner_bin)

. label variable partner_bin "Spouse/Life Partner"

. 
. label define partner_bin 0 "[0] Does not have a Spouse/Life Partner", modify

. label define partner_bin 1 "[1] Has a Spouse/Life Partner", modify

. 
. label values partner_bin partner_bin

. 
. gen partner_bin_female = partner_bin * female

. label variable partner_bin_female "Spouse/Life Partner $\times$ Female"

. 
. 
. * household size
. merge m:1 hid syear using ${v38}hbrutto, keep(3) keepusing(hhgr) nogen
(label intid_EN already defined)
(label socurban_EN already defined)
(label bula_ew_EN already defined)
(label sampreg_EN already defined)
(label hpmax_EN already defined)
(label syear_EN already defined)
(label cid_EN already defined)
(label hid_EN already defined)
(label intid already defined)
(label socurban already defined)
(label bula_ew already defined)
(label sampreg already defined)
(label hpmax already defined)
(label syear already defined)
(label cid already defined)
(label hid already defined)

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                           199,582  
    -----------------------------------------

. 
. gen hhgr_female = hhgr * female

. label variable hhgr "Household Size"

. label variable hhgr_female "Household Size $\times$ Female"

. 
. 
. ** RESTRICTED AREA **
. merge m:1 hid syear using ${restricted}regionl, keep(3) keepusing(regbez kr_emprate kr_popdens) nogen
(label nuts1_EN already defined)
(label nuts2_EN already defined)
(label nuts3_EN already defined)
(label kkz_rek90_EN already defined)
(label kkz_rek_EN already defined)
(label kkz_EN already defined)
(label ror96_EN already defined)
(label ror8595_EN already defined)
(label bik_EN already defined)
(label gtyp_EN already defined)
(label ggk_EN already defined)
(label gbou_EN already defined)
(label regbez_EN already defined)
(label bbrkrstyp_EN already defined)
(label bbrgtyp_EN already defined)
(label socurban_EN already defined)
(label regtyp_EN already defined)
(label bula_ew_EN already defined)
(label bula_EN already defined)
(label nuts1 already defined)
(label nuts2 already defined)
(label nuts3 already defined)
(label kkz_rek90 already defined)
(label kkz_rek already defined)
(label kkz already defined)
(label ror96 already defined)
(label ror8595 already defined)
(label bik already defined)
(label gtyp already defined)
(label ggk already defined)
(label gbou already defined)
(label regbez already defined)
(label bbrkrstyp already defined)
(label bbrgtyp already defined)
(label socurban already defined)
(label regtyp already defined)
(label bula_ew already defined)
(label bula already defined)

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                           199,582  
    -----------------------------------------

. 
. label variable kr_emprate "Employment Rate in County of Residence"

. label variable kr_popdens "Population Density in County of Residence"

. 
. 
. * individual lives in the "mitteldeutsche chemiedreieck"
. gen chemiedreieck = 0

. replace chemiedreieck = 1 if inlist(regbez, 142, 152) // ([152] halle, [142] leipzig)
(5,690 real changes made)

. 
. gen chemiedreieck_female = chemiedreieck * female

. 
. label variable chemiedreieck "Residence in Chemiedreieck"

. label variable chemiedreieck_female "Residence in Chemiedreieck $\times$ Female"

. 
. label define chemiedreieck 0 "[0] Does not reside in the Chemiedreieck", modify

. label define chemiedreieck 1 "[1] Resides in the Chemiedreieck", modify

. 
. label values chemiedreieck chemiedreieck

. **
. 
. 
. * save dataset
. compress
  variable eintritt was float now int
  variable erstbefr was float now int
  variable austritt was float now int
  variable letztbef was float now int
  variable sampreg was float now byte
  variable netto was float now byte
  variable nett1 was float now byte
  variable pop was float now byte
  variable loc1989 was float now byte
  variable locinfo was float now byte
  variable birthregion was float now byte
  variable birthregion_ew was float now byte
  variable arefback was float now byte
  variable arefinfo was float now byte
  variable d1991 was float now byte
  variable female_d1991 was float now byte
  variable d1992 was float now byte
  variable female_d1992 was float now byte
  variable d1993 was float now byte
  variable female_d1993 was float now byte
  variable d1994 was float now byte
  variable female_d1994 was float now byte
  variable d1995 was float now byte
  variable female_d1995 was float now byte
  variable d1996 was float now byte
  variable female_d1996 was float now byte
  variable d1997 was float now byte
  variable female_d1997 was float now byte
  variable d1998 was float now byte
  variable female_d1998 was float now byte
  variable d1999 was float now byte
  variable female_d1999 was float now byte
  variable west_female was float now byte
  variable east_origin was float now byte
  variable stem was int now byte
  variable pgemplst was float now byte
  variable age was float now byte
  variable age_2 was float now int
  variable partner_bin_female was float now byte
  variable hhgr_female was float now byte
  variable chemiedreieck was float now byte
  variable chemiedreieck_female was float now byte
  variable syear was double now int
  variable partner was double now byte
  variable casemat was double now long
  variable sexor was double now byte
  variable sexorinfo was double now byte
  variable partner_bin was double now byte
  (31,334,374 bytes saved)

. save ${data}female_stem, replace
file H:/master_thesis/stata/data/female_stem.dta saved

. 
end of do-file

. * graphical pre-analysis
. do ${do}graphical_preanalysis.do

. ** DO NOT EXECUTE THIS DO-FILE ON ITS OWN, DO MAIN.DO !! **
. 
. use ${data}female_stem, clear
(SOEP-Core, v38.1 (EU Edition), doi:10.5684/soep.core.v38.1eu)

. 
. 
. collapse (mean) stem (count) pid [aw = phrf], by(syear east_origin female)
(note: aweights not used to compute counts)

. 
. * infos on bin sizes for notes
. sum pid

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         pid |        124    1583.427    1360.307        182       5160

. local size_mean = round(r(mean))

. local size_sd   = round(r(sd))

. 
. local fmt_size_mean : di %5.0fc `size_mean'

. local fmt_size_sd   : di %5.0fc `size_sd'

. 
. 
. sum pid if female == 1 & inrange(syear, 1990, 1996)

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
         pid |         14    1072.571    746.2587        199       2324

. local size_mean_female = round(r(mean))

. local size_sd_female   = round(r(sd))

. 
. local fmt_size_mean_female : di %5.0fc `size_mean_female'

. local fmt_size_sd_female   : di %3.0fc `size_sd_female'

. 
. 
. * share of stem professionals within demographic groups (1990-1999)
. twoway (connected stem syear if female == 0 & east_origin == 1, mcolor(gs6) lcolor(gs6) msymbol(O) lpattern(solid)) ///
> ||     (connected stem syear if female == 0 & east_origin == 0, mcolor(gs6) lcolor(gs6) msymbol(Oh) lpattern(dash)) ///
> ||     (connected stem syear if female == 1 & east_origin == 0, mcolor(gs6) lcolor(gs6) msymbol(Sh) lpattern(dash)) ///
> ||     (connected stem syear if female == 1 & east_origin == 1, mcolor(black) lcolor(black) msymbol(S) lpattern(solid)), ///
> xline(1990, lcolor(gray) lpattern(dash)) ///
> xtitle("Survey Year") ///
> ytitle("Share of STEM Professionals within Bin") ///
> ylabel(0.05(0.05)0.2, format(%03.2f)) ///
> legend(label(1 "East Origin, Male") ///
>        label(2 "West Origin, Male") ///
>            label(3 "West Origin, Female") ///
>            label(4 "East Origin, Female") ///
>            order(4 3 1 2)) ///
> note("Avg. Bin Size (Std. Dev.): `fmt_size_mean' (`fmt_size_sd')") ///
> name(trend, replace)

. 
. graph export "${figures}trend.pdf", replace
file H:/master_thesis/stata/figures/trend.pdf saved as PDF format

. 
. 
. * trend, zoomed
. use ${data}female_stem, clear
(SOEP-Core, v38.1 (EU Edition), doi:10.5684/soep.core.v38.1eu)

. 
. keep if inrange(syear, 1990, 1999) & female == 1
(177,354 observations deleted)

. 
. statsby stem=r(mean) lb=r(lb) ub=r(ub) [aw = phrf], by(syear east_origin female) clear: ci means stem
(running ci on estimation sample)

      Command: ci means stem [aweight= phrf]
         stem: r(mean)
           lb: r(lb)
           ub: r(ub)
           By: syear east_origin female

Statsby groups
----+--- 1 ---+--- 2 ---+--- 3 ---+--- 4 ---+--- 5 
....................

. 
. 
. * share of stem professionals within demographic groups (females only, 1990-1999)
. twoway (connected stem syear if east_origin == 0, mcolor(gs6) lcolor(gs6) msymbol(Sh) lpattern(dash)) ///
> ||     (connected stem syear if east_origin == 1, mcolor(black) lcolor(black) msymbol(S) lpattern(solid)) ///
> ||     (rcap lb ub syear if east_origin == 0, lcolor(gs6)) ///
> ||     (rcap lb ub syear if east_origin == 1, lcolor(black)), ///
> xtitle("Survey Year") ///
> ytitle("Share of STEM Professionals within Bin") ///
> ylabel(0.05(0.05)0.2, format(%03.2f) nogrid) ///
> legend(label(1 "West Origin, Female") ///
>            label(2 "East Origin, Female") ///
>            order(2 1)) ///
> note("Avg. Bin Size (Std. Dev.): `fmt_size_mean_female' (`fmt_size_sd_female')") ///
> name(trend_zoomed, replace)

. 
. graph export "${figures}trend_zoomed.pdf", replace
file H:/master_thesis/stata/figures/trend_zoomed.pdf saved as PDF format

. 
end of do-file

. * validity analysis
. do ${do}validity.do

. ** DO NOT EXECUTE THIS DO-FILE ON ITS OWN, DO MAIN.DO !! **
. 
. * use mayer (1995) data to look at stem trend in gdr
. use ${data}ZA2644_LVost/ZA2644_data_v1-0-0_dta/ERWERB, clear

. merge m:1 FALLNR using ${data}ZA2644_LVost/ZA2644_data_v1-0-0_dta/LMUTTER, keep(3) nogen keepusing(SEX KOHORTE)

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                            10,583  
    -----------------------------------------

. 
. 
. * all variables in lower case
. foreach var of varlist * {
  2.      rename `var' `= lower("`var'")'
  3. }

. 
. 
. * drop if case is not part of a cohort
. drop if kohorte == 9
(9 observations deleted)

. 
. 
. * sort data
. sort fallnr spellnr

. 
. 
. * female dummy
. recode sex (2 = 1) (1 = 0) (nonmissing = .), gen(female)
(10574 differences between sex and female)

. 
. label variable female "Female"

. 
. label define female 0 "[0] Male", modify

. label define female 1 "[1] Female", modify

. 
. label values female female

. 
. drop if mi(female)
(0 observations deleted)

. 
. 
. * drop cases with missing occupation
. drop if inlist(f401i3, -1, 1004, 1009)
(962 observations deleted)

. 
. * start of occupation
. gen startocc = bg05403 + 1900

. drop if startocc == 1900 | startocc > 1990
(585 observations deleted)

. label variable startocc "Year of Start of Occupation"

. 
. drop if mi(startocc)
(0 observations deleted)

. 
. * drop if occupation started before 1945
. drop if startocc < 1945
(114 observations deleted)

. 
. * start of occupation (in decades)
. recode startocc (1945/1949 = 1) (1950/1959 = 2) (1960/1969 = 3) ///
>                                 (1970/1979 = 4) (1980/1990 = 5), gen(startocc_cat)
(8913 differences between startocc and startocc_cat)

. 
. label variable startocc_cat "Year of Start of Occupation (categorised)"

. 
. label define startocc_cat 1 "1945--1949", modify

. label define startocc_cat 2 "1950--1959", modify

. label define startocc_cat 3 "1960--1969", modify

. label define startocc_cat 4 "1970--1979", modify

. label define startocc_cat 5 "1980--1990", modify

. 
. label values startocc_cat startocc_cat

. 
. * mark stem profession
. recode f401i3 (11/54 = 1) (81/91 = 1) (nonmissing = 0), gen(stem)
(8913 differences between f401i3 and stem)

. 
. label variable stem "STEM Profession"

. 
. label define stem 0 "[0] Does not have a STEM Profession", modify

. label define stem 1 "[1] Has a STEM Profession", modify

. 
. label values stem stem

. 
. drop if mi(stem)
(0 observations deleted)

. 
. * save dataset
. compress
  variable startocc was float now int
  variable startocc_cat was float now byte
  variable stem was int now byte
  (53,478 bytes saved)

. save ${data}validity, replace
file H:/master_thesis/stata/data/validity.dta saved

. 
. * graphical analysis
. collapse (mean) stem (count) fallnr, by(startocc_cat female) 

. 
. * infos on bin sizes for notes
. sum fallnr

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
      fallnr |         10       891.3    340.0683        365       1365

. local size_mean = round(r(mean))

. local size_sd   = round(r(sd))

. 
. local fmt_size_mean : di %3.0fc `size_mean'

. local fmt_size_sd   : di %3.0fc `size_sd'

. 
. use ${data}validity, clear

. 
. statsby stem=r(mean) lb=r(lb) ub=r(ub), by(startocc_cat female) clear: ci means stem
(running ci on estimation sample)

      Command: ci means stem
         stem: r(mean)
           lb: r(lb)
           ub: r(ub)
           By: startocc_cat female

Statsby groups
----+--- 1 ---+--- 2 ---+--- 3 ---+--- 4 ---+--- 5 
..........

. 
. twoway (connected stem startocc_cat if female == 0, mcolor(gs6) lcolor(gs6) msymbol(O) lpattern(solid)) ///
> ||     (connected stem startocc_cat if female == 1, mcolor(black) lcolor(black) msymbol(S) lpattern(solid)) ///
> ||     (rcap lb ub startocc_cat if female == 0, lcolor(gs6)) ///
> ||     (rcap lb ub startocc_cat if female == 1, lcolor(black)), ///
> xtitle("Year of Start of Occupation") ///
> ytitle("Share of STEM Professionals within Bin") ///
> xlabel(1 2 3 4 5, valuelabel) ///
> ylabel(0.05(0.05)0.2, format(%03.2f) nogrid) ///
> legend(label(1 "Male") ///
>        label(2 "Female") ///
>            order(2 1)) ///
> note("Avg. Bin Size (Std. Dev.): `fmt_size_mean' (`fmt_size_sd')") ///
> name(cohorts, replace)

. 
. graph export "${figures}validity.pdf", replace
file H:/master_thesis/stata/figures/validity.pdf saved as PDF format

. 
. 
. *-----
. 
. 
. * look at individuals from estimation sample in 1990
. use ${data}female_stem, clear
(SOEP-Core, v38.1 (EU Edition), doi:10.5684/soep.core.v38.1eu)

. 
. 
. * keep east germans only -> only look at 1990
. keep if east_origin == 0 & syear == 1990
(198,454 observations deleted)

. drop east_origin

. 
. 
. estimates clear

. 
. eststo female: quietly estpost summarize ///
>     stem age partner_bin hhgr west chemiedreieck if female == 1

. eststo male: quietly estpost summarize ///
>     stem age partner_bin hhgr west chemiedreieck if female == 0

. eststo diff: quietly estpost ttest ///
>     stem age partner_bin hhgr west chemiedreieck, by(female) unequal

. 
. 
. * direct output in log
. esttab female male diff, ///
>         cells("mean(pattern(1 1 0) fmt(2)) sd(par pattern(1 1 0)) b(star pattern(0 0 1) fmt(2)) se(pattern(0 0 1) par fmt(2))") ///
>         label

-----------------------------------------------------------------------------------------------------
                              (1)                       (2)                       (3)                
                                                                                                     
                             mean           sd         mean           sd            b              se
-----------------------------------------------------------------------------------------------------
STEM Profession              0.04       (0.20)         0.11       (0.31)         0.06***       (0.02)
Age                         30.14       (9.84)        30.31      (10.21)         0.17          (0.60)
Spouse/Life Partner          0.63       (0.48)         0.56       (0.50)        -0.07*         (0.03)
Household Size               3.21       (1.51)         3.31       (1.65)         0.10          (0.09)
Residence in West ~y         0.97       (0.18)         0.97       (0.17)         0.00          (0.01)
Residence in Chemi~k         0.00       (0.00)         0.00       (0.00)         0.00          (0.00)
-----------------------------------------------------------------------------------------------------
Observations                  529                       599                      1128                
-----------------------------------------------------------------------------------------------------

. 
. 
. * latex export
. esttab female male diff using ${tables}descriptives90.tex, ///
>         cells("mean(pattern(1 1 0) fmt(2)) sd(par pattern(1 1 0)) b(star pattern(0 0 1) fmt(2)) se(pattern(0 0 1) par fmt(2))") ///
>         label booktabs replace
(output written to H:/master_thesis/stata/../latex/tables/descriptives90.tex)

. 
end of do-file

. * regression analysis
. //do ${do}regression_analysis.do
. * eastern female tracking
. do ${do}eastern_female_tracking.do

. ** DO NOT EXECUTE THIS DO-FILE ON ITS OWN, DO MAIN.DO !! **
. 
. use ${data}female_stem, clear
(SOEP-Core, v38.1 (EU Edition), doi:10.5684/soep.core.v38.1eu)

. 
. 
. * keep east german females only
. keep if east_origin == 1 & inrange(syear, 1990, 1999) & female == 1
(190,300 observations deleted)

. drop east_origin

. 
. 
. * number of individuals in 1990 for notes
. egen sumpid = count(pid) if syear == 1990
(7,669 missing values generated)

. sum sumpid

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
      sumpid |      1,613        1613           0       1613       1613

. local sumpid = r(mean)

. drop sumpid

. 
. egen sumstem = count(pid) if syear == 1990 & stem == 1
(9,113 missing values generated)

. sum sumstem

    Variable |        Obs        Mean    Std. dev.       Min        Max
-------------+---------------------------------------------------------
     sumstem |        169         169           0        169        169

. local sumstem = r(mean)

. drop sumstem

. 
. local fmt_sumpid : di %5.0fc `sumpid'

. 
. 
. * individuals switches from being occupied in stem to not being occupied in stem
. * individuals switching the other way around get accounted as -1 to get net switches
. gen stem_switch = 0

. bysort pid (syear): replace stem_switch = 1 if stem == 0 & stem[_n-1] == 1
(160 real changes made)

. bysort pid (syear): replace stem_switch = -1 if stem == 1 & stem[_n-1] == 0
(89 real changes made)

. 
. 
. * individuals switches from being employed (either full- or part-time) to not being employed
. * individuals switching the other way around get accounted as -1 to get net switches
. gen unemp_switch = 0

. bysort pid (syear): replace unemp_switch = 1 if inrange(pgemplst, 3, 6) & (pgemplst[_n-1] == 1 | pgemplst[_n-1] == 2)
(162 real changes made)

. bysort pid (syear): replace unemp_switch = -1 if (pgemplst == 1 | pgemplst == 2) & inrange(pgemplst[_n-1], 3, 6)
(270 real changes made)

. 
. 
. * individuals switches from being occupied in stem to not being employed
. * individuals switching the other way around get accounted as -1 to get net switches
. gen stem_unemp_switch = 0

. bysort pid (syear): replace stem_unemp_switch = 1 if inrange(pgemplst, 3, 6) & (pgemplst[_n-1] == 1 | pgemplst[_n-1] == 2) & stem[_n-1
> ] == 1
(17 real changes made)

. bysort pid (syear): replace stem_unemp_switch = -1 if (pgemplst == 1 | pgemplst == 2) & stem == 1 & inrange(pgemplst[_n-1], 3, 6)
(10 real changes made)

. 
. 
. collapse (sum) stem_switch unemp_switch stem_unemp_switch (count) pid [aw = phrf], by(syear)
(note: aweights not used to compute counts)

. 
. twoway (line unemp_switch syear, lcolor(gs8) lpattern(solid)) ///
> ||     (connected stem_unemp_switch syear [w = pid], lcolor(gs4) mcolor(gs4) msymb(oh) lpattern(solid)) ///
> ||     (line stem_switch syear, lcolor(black) lpattern(solid)), ///
>         xtitle("Survey Year") ///
>         ytitle("Net Switches") ///
>         ylab(, nogrid) ///
>         xlab(, nogrid) ///
>         legend(label(1 "STEM to Unemployment") ///
>                label(2 "Employment (Full- or Part-Time) to Unemployment") ///
>                    label(3 "STEM to non-STEM") ///
>                    order(3 2 1) ///
>                    position(6)) ///
>         note("N = `fmt_sumpid', thereof `sumstem' in STEM.") ///
>         name(eastern_female_tracking, replace)
(analytic weights assumed)
(analytic weights assumed)
(analytic weights assumed)

. 
. graph export "${figures}eastern_female_tracking.pdf", replace
file H:/master_thesis/stata/figures/eastern_female_tracking.pdf saved as PDF format

. 
. 
. * survival plot 
. * get eastern female stem professionals of 1990 and see how they develop
. use ${data}female_stem, clear
(SOEP-Core, v38.1 (EU Edition), doi:10.5684/soep.core.v38.1eu)

. keep if syear == 1990 & stem == 1 & east_origin == 1 & female == 1
(199,413 observations deleted)

. keep pid

. 
. 
. merge 1:m pid using ${data}female_stem, keep(3) nogen
(label hhgr already defined)
(label hhgr_EN already defined)
(label stem already defined)
(label p_isco88 already defined)
(label pid_EN already defined)
(label hid_EN already defined)
(label cid_EN already defined)
(label syear_EN already defined)
(label p_isco88_EN already defined)
(label female already defined)
(label reclin_iab_match_EN already defined)
(label rv_id_EN already defined)
(label arefinfo_EN already defined)
(label arefback_EN already defined)
(label birthregion_ew_EN already defined)
(label birthregion_EN already defined)
(label locinfo_EN already defined)
(label sexorinfo_EN already defined)
(label sexor_EN already defined)
(label immiyearinfo_EN already defined)
(label corigininfo_EN already defined)
(label germborninfo_EN already defined)
(label miginfo_EN already defined)
(label migback_EN already defined)
(label loc1989_EN already defined)
(label gebmonat_EN already defined)
(label corigin_EN already defined)
(label germborn_EN already defined)
(label todinfo_EN already defined)
(label pop_EN already defined)
(label casemat_EN already defined)
(label nett1_EN already defined)
(label netto_EN already defined)
(label sampreg_EN already defined)
(label psample_EN already defined)
(label sex_EN already defined)
(label partner_EN already defined)
(label reclin_iab_match already defined)
(label rv_id already defined)
(label arefinfo already defined)
(label arefback already defined)
(label birthregion_ew already defined)
(label birthregion already defined)
(label locinfo already defined)
(label sexorinfo already defined)
(label sexor already defined)
(label immiyearinfo already defined)
(label corigininfo already defined)
(label germborninfo already defined)
(label miginfo already defined)
(label migback already defined)
(label loc1989 already defined)
(label gebmonat already defined)
(label corigin already defined)
(label germborn already defined)
(label todinfo already defined)
(label pop already defined)
(label casemat already defined)
(label nett1 already defined)
(label netto already defined)
(label sampreg already defined)
(label psample already defined)
(label sex already defined)
(label partner already defined)
(label regbez_EN already defined)
(label bula_EN already defined)
(label regbez already defined)
(label bula already defined)
(label west already defined)
(label east_origin already defined)
(label pgemplst_EN already defined)
(label pgemplst already defined)
(label partner_bin already defined)
(label chemiedreieck already defined)

    Result                      Number of obs
    -----------------------------------------
    Not matched                             0
    Matched                             1,348  
    -----------------------------------------

. keep if inrange(syear, 1990, 1999)
(488 observations deleted)

. 
. * create status variable [1] stem [2] working in non-stem [3] non-working [4] punr
. gen status = .
(860 missing values generated)

. replace status = 1 if stem == 1
(445 real changes made)

. replace status = 2 if stem == 0 & inlist(pgemplst, 1, 2)
(388 real changes made)

. replace status = 3 if stem == 0 & !inlist(pgemplst, 1, 2)
(27 real changes made)

. 
. 
. label variable status "Work Status"

. label define status 1 "Working in STEM", modify

. label define status 2 "Working in Non-STEM", modify

. label define status 3 "Non-Working", modify

. label define status 4 "Partial Unit-Nonresponse", modify

. 
. label values status status

. 
. 
. save ${data}survival, replace
file H:/master_thesis/stata/data/survival.dta saved

. 
. 
. * count punr's
. collapse (sum) stem (count) pid, by(syear)

. gen punr = pid[1] - pid

. save ${data}punr, replace
file H:/master_thesis/stata/data/punr.dta saved

. 
. * get punr's into the status variable
. forvalues year = 1(1)10 {
  2.         
.         use ${data}punr, clear
  3.         local punr = punr[`year']
  4.         
.         
.         use ${data}survival, clear
  5.         local oldobs = _N + 1
  6.         local newobs = _N + `punr'
  7.         set obs `newobs'
  8.         
.         if `oldobs' < `newobs' {
  9.                 replace syear = 1989 + `year' in `oldobs'/`newobs'
 10.                 replace status = 4 in `oldobs'/`newobs'
 11.         }
 12.         
.         save ${data}survival, replace
 13. }
(SOEP-Core, v38.1 (EU Edition), doi:10.5684/soep.core.v38.1eu)
(SOEP-Core, v38.1 (EU Edition), doi:10.5684/soep.core.v38.1eu)
Number of observations (_N) was 860, now 860.
file H:/master_thesis/stata/data/survival.dta saved
(SOEP-Core, v38.1 (EU Edition), doi:10.5684/soep.core.v38.1eu)
(SOEP-Core, v38.1 (EU Edition), doi:10.5684/soep.core.v38.1eu)
Number of observations (_N) was 860, now 901.
(41 real changes made)
(41 real changes made)
file H:/master_thesis/stata/data/survival.dta saved
(SOEP-Core, v38.1 (EU Edition), doi:10.5684/soep.core.v38.1eu)
(SOEP-Core, v38.1 (EU Edition), doi:10.5684/soep.core.v38.1eu)
Number of observations (_N) was 901, now 959.
(58 real changes made)
(58 real changes made)
file H:/master_thesis/stata/data/survival.dta saved
(SOEP-Core, v38.1 (EU Edition), doi:10.5684/soep.core.v38.1eu)
(SOEP-Core, v38.1 (EU Edition), doi:10.5684/soep.core.v38.1eu)
Number of observations (_N) was 959, now 1,017.
(58 real changes made)
(58 real changes made)
file H:/master_thesis/stata/data/survival.dta saved
(SOEP-Core, v38.1 (EU Edition), doi:10.5684/soep.core.v38.1eu)
(SOEP-Core, v38.1 (EU Edition), doi:10.5684/soep.core.v38.1eu)
Number of observations (_N) was 1,017, now 1,155.
(138 real changes made)
(138 real changes made)
file H:/master_thesis/stata/data/survival.dta saved
(SOEP-Core, v38.1 (EU Edition), doi:10.5684/soep.core.v38.1eu)
(SOEP-Core, v38.1 (EU Edition), doi:10.5684/soep.core.v38.1eu)
Number of observations (_N) was 1,155, now 1,220.
(65 real changes made)
(65 real changes made)
file H:/master_thesis/stata/data/survival.dta saved
(SOEP-Core, v38.1 (EU Edition), doi:10.5684/soep.core.v38.1eu)
(SOEP-Core, v38.1 (EU Edition), doi:10.5684/soep.core.v38.1eu)
Number of observations (_N) was 1,220, now 1,377.
(157 real changes made)
(157 real changes made)
file H:/master_thesis/stata/data/survival.dta saved
(SOEP-Core, v38.1 (EU Edition), doi:10.5684/soep.core.v38.1eu)
(SOEP-Core, v38.1 (EU Edition), doi:10.5684/soep.core.v38.1eu)
Number of observations (_N) was 1,377, now 1,455.
(78 real changes made)
(78 real changes made)
file H:/master_thesis/stata/data/survival.dta saved
(SOEP-Core, v38.1 (EU Edition), doi:10.5684/soep.core.v38.1eu)
(SOEP-Core, v38.1 (EU Edition), doi:10.5684/soep.core.v38.1eu)
Number of observations (_N) was 1,455, now 1,537.
(82 real changes made)
(82 real changes made)
file H:/master_thesis/stata/data/survival.dta saved
(SOEP-Core, v38.1 (EU Edition), doi:10.5684/soep.core.v38.1eu)
(SOEP-Core, v38.1 (EU Edition), doi:10.5684/soep.core.v38.1eu)
Number of observations (_N) was 1,537, now 1,690.
(153 real changes made)
(153 real changes made)
file H:/master_thesis/stata/data/survival.dta saved

. 
. set scheme s2color

. 
. graph bar, ///
>         over(status) ///
>         over(syear) ///
>         stack asyvars ///
>         percentage ///
>         ylab(, nogrid) ///
>         ytitle("Percent") ///
>         graphregion(color(white)) ///
>         name(survival, replace)

. 
. graph export ${figures}survival.pdf, replace
file H:/master_thesis/stata/figures/survival.pdf saved as PDF format

.         
. * reset scheme
. set scheme tufte

. 
. 
end of do-file

. 
. 
. * erase tempfiles
. erase ${data}female_stem.dta

. erase ${data}validity.dta

. 
. * close log file
. log close master_thesis
      name:  master_thesis
       log:  H:/master_thesis/stata/log/master_thesis_running.log
  log type:  text
 closed on:   1 Jul 2024, 19:46:23
----------------------------------------------------------------------------------------------------------------------------------------
